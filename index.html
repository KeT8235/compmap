<html lang="ko">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>



  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" href="Ende_LOGO.png">
  <link rel="stylesheet" href="html5Doctor.css">
  <link rel="stylesheet" href="style.css">
  <title>R6 맵 전략 툴</title>



  <!-- 아이콘 배치-->
  <!-- 공격측 영역 -->
  <div class="attack_slot">
    <!--  <img src="name.jpg" alt="" class="drag-and-drop icon" id="name" draggable="true"> -->
    <img src="striker.jpg" alt="" class="drag-and-drop icon" id="striker" draggable="true">
    <img src="sledge.jpg" alt="" class="drag-and-drop icon" id="sledge" draggable="true">
    <img src="thatcher.jpg" alt="" class="drag-and-drop icon" id="thatcher" draggable="true">
    <img src="ash.jpg" alt="" class="drag-and-drop icon" id="ash" draggable="true">
    <img src="thermite.jpg" alt="" class="drag-and-drop icon" id="thermite" draggable="true">
    <img src="twitch.jpg" alt="" class="drag-and-drop icon" id="twitch" draggable="true">
    <img src="montagne.jpg" alt="" class="drag-and-drop icon" id="montagne" draggable="true">
    <img src="glaz.jpg" alt="" class="drag-and-drop icon" id="glaz" draggable="true">
    <img src="fuze.jpg" alt="" class="drag-and-drop icon" id="fuze" draggable="true">
    <img src="blitz.jpg" alt="" class="drag-and-drop icon" id="blitz" draggable="true">
    <img src="iq.jpg" alt="" class="drag-and-drop icon" id="iq" draggable="true">
    <img src="buck.jpg" alt="" class="drag-and-drop icon" id="buck" draggable="true">
    <img src="blackbeard.jpg" alt="" class="drag-and-drop icon" id="blackbeard" draggable="true">
    <img src="capitao.jpg" alt="" class="drag-and-drop icon" id="capitao" draggable="true">
    <img src="hibana.jpg" alt="" class="drag-and-drop icon" id="hibana" draggable="true">
    <img src="jackal.jpg" alt="" class="drag-and-drop icon" id="jackal" draggable="true">
    <img src="ying.jpg" alt="" class="drag-and-drop icon" id="ying" draggable="true">
    <img src="zofia.jpg" alt="" class="drag-and-drop icon" id="zofia" draggable="true">
    <img src="dokkaebi.jpg" alt="" class="drag-and-drop icon" id="dokkaebi" draggable="true">
    <img src="lion.jpg" alt="" class="drag-and-drop icon" id="lion" draggable="true">
    <img src="finka.jpg" alt="" class="drag-and-drop icon" id="finka" draggable="true">
    <img src="maverick.jpg" alt="" class="drag-and-drop icon" id="maverick" draggable="true">
    <img src="nomad.jpg" alt="" class="drag-and-drop icon" id="nomad" draggable="true">
    <img src="gridlock.jpg" alt="" class="drag-and-drop icon" id="gridlock" draggable="true">
    <img src="nokk.jpg" alt="" class="drag-and-drop icon" id="nokk" draggable="true">
    <img src="amaru.jpg" alt="" class="drag-and-drop icon" id="amaru" draggable="true">
    <img src="kali.jpg" alt="" class="drag-and-drop icon" id="kali" draggable="true">
    <img src="iana.jpg" alt="" class="drag-and-drop icon" id="iana" draggable="true">
    <img src="ace.jpg" alt="" class="drag-and-drop icon" id="ace" draggable="true">
    <img src="zero.jpg" alt="" class="drag-and-drop icon" id="zero" draggable="true">
    <img src="flores.jpg" alt="" class="drag-and-drop icon" id="flores" draggable="true">
	  <img src="osa.jpg" alt="" class="drag-and-drop icon" id="osa" draggable="true">
    <img src="sens.jpg" alt="" class="drag-and-drop icon" id="sens" draggable="true">
    <img src="grim.jpg" alt="" class="drag-and-drop icon" id="grim" draggable="true">
    <img src="brava.jpg" alt="" class="drag-and-drop icon" id="brava" draggable="true">
    <img src="ram.jpg" alt="" class="drag-and-drop icon" id="ram" draggable="true">
    <img src="deimos.jpg" alt="" class="drag-and-drop icon" id="deimos" draggable="true">
    <img src="rauora.jpg" alt="" class="drag-and-drop icon" id="rauora" draggable="true">


    <div class="drone_slot">
      <span>정찰 드론</span>
    </div>
    <img src="drone.jpg" alt="" class="drone gadget drag-and-drop" draggable="true">
    
    <div class="bleaching_slot">
      <span>접착 폭약</span>
    </div>
    <img src="bleaching.jpg" alt="" class="bleaching gadget drag-and-drop" draggable="true">
    
    <div class="claymore_slot">
      <span>대인 지뢰</span>
    </div>
    <img src="claymore.jpg" alt="" class="claymore gadget drag-and-drop" draggable="true">

    <div class="smoke_slot">
      <span>연막탄</span>
    </div>
    <img src="smoke.jpg" alt="" class="smoke gadget drag-and-drop" draggable="true">

    <div class="grenade_slot">
      <span>수류탄</span>
    </div>
    <img src="grenade.jpg" alt="" class="grenade gadget drag-and-drop" draggable="true">

    <div class="flash_slot">
      <span>섬광탄</span>
    </div>
    <img src="flash.jpg" alt="" class="flash gadget drag-and-drop" draggable="true">

    <div class="diffuser_slot">
      <span>폭탄 해체<br>장치</span>
    </div>
    <img src="diffuser.jpg" alt="" class="diffuser gadget drag-and-drop" draggable="true">

    <div class="hardbleaching_slot">
      <span>강력 접착<br>폭약</span>
    </div>
    <img src="hardbleaching.jpg" alt="" class="hardbleaching gadget drag-and-drop" draggable="true">
    
    <div class="emp_slot">
	    <span>충격 EMP<br>수류탄</span>
    </div>
    <img src="emp.png" alt="" class="emp gadget drag-and-drop" draggable="true">
  </div>
<!-- 공격측 영역 끝-->


<!-- 숫자 아이콘 영역-->
  <div class="number_slot">
    <h1 class="number_slot_title">숫자 아이콘</h1>
    <div class="drag-and-drop numbers No_1" draggable="true">
     <h1>1</h1>
    </div>
    <div class="drag-and-drop numbers No_2" draggable="true">
      <h1>2</h1>
    </div>
    <div class="drag-and-drop numbers No_3" draggable="true">
      <h1>3</h1>
    </div>
    <div class="drag-and-drop numbers No_4" draggable="true">
      <h1>4</h1>
    </div>
    <div class="drag-and-drop numbers No_5" draggable="true">
      <h1>5</h1>
    </div>
  </div>
<!-- 숫자 아이콘 영역 끝-->
  
<br>


  <!-- 방어측 영역-->
  <div class="defense_slot">
    <!--  <img src="name.jpg" alt="" class="drag-and-drop icon" id="name" draggable="true"> -->
    <img src="sentry.jpg" alt="" class="drag-and-drop icon" id="sentry" draggable="true">
    <img src="skopos.jpg" alt="" class="drag-and-drop icon" id="skopos" draggable="true">
    <img src="smoke.jpg" alt="" class="drag-and-drop icon" id="smoke" draggable="true">
    <img src="mute.jpg" alt="" class="drag-and-drop icon" id="mute" draggable="true">
    <img src="castle.jpg" alt="" class="drag-and-drop icon" id="castle" draggable="true">
    <img src="pulse.jpg" alt="" class="drag-and-drop icon" id="pulse" draggable="true">
    <img src="doc.jpg" alt="" class="drag-and-drop icon" id="doc" draggable="true">
    <img src="rook.jpg" alt="" class="drag-and-drop icon" id="rook" draggable="true">
    <img src="kapkan.jpg" alt="" class=" drag-and-drop icon" id="kapkan" draggable="true">
    <img src="tachanka.jpg" alt="" class="drag-and-drop icon" id="tachanka" draggable="true">
    <img src="jaeger.jpg" alt="" class="drag-and-drop icon" id="jaeger" draggable="true">
    <img src="bandit.jpg" alt="" class="drag-and-drop icon" id="bandit" draggable="true">
    <img src="frost.jpg" alt="" class="drag-and-drop icon" id="frost" draggable="true">
    <img src="valkyrie.jpg" alt="" class="drag-and-drop icon" id="valkyrie" draggable="true">
    <img src="caveira.jpg" alt="" class="drag-and-drop icon" id="caveira" draggable="true">
    <img src="echo.jpg" alt="" class="drag-and-drop icon" id="echo" draggable="true">
    <img src="mira.jpg" alt="" class="drag-and-drop icon" id="mira" draggable="true">
    <img src="lesion.jpg" alt="" class="drag-and-drop icon" id="lesion" draggable="true">
    <img src="ela.jpg" alt="" class="drag-and-drop icon" id="ela" draggable="true">
    <img src="vigil.jpg" alt="" class="drag-and-drop icon" id="vigil" draggable="true">
    <img src="maestro.jpg" alt="" class="drag-and-drop icon" id="maestro" draggable="true">
    <img src="alibi.jpg" alt="" class="drag-and-drop icon" id="alibi" draggable="true">
    <img src="clash.jpg" alt="" class="drag-and-drop icon" id="clash" draggable="true">
    <img src="kaid.jpg" alt="" class="drag-and-drop icon" id="kaid" draggable="true">
    <img src="mozzie.jpg" alt="" class="drag-and-drop icon" id="mozzie" draggable="true">
    <img src="warden.jpg" alt="" class="drag-and-drop icon" id="warden" draggable="true">
    <img src="goyo.jpg" alt="" class="drag-and-drop icon" id="goyo" draggable="true">
    <img src="wamai.jpg" alt="" class="drag-and-drop icon" id="wamai" draggable="true">
    <img src="oryx.jpg" alt="" class="drag-and-drop icon" id="oryx" draggable="true">
    <img src="melusi.jpg" alt="" class="drag-and-drop icon" id="melusi" draggable="true">
    <img src="aruni.jpg" alt="" class="drag-and-drop icon" id="aruni" draggable="true">
    <img src="thunderbird.jpg" alt="" class="drag-and-drop icon" id="thunderbird" draggable="true">
    <img src="thorn.jpg" alt="" class="drag-and-drop icon" id="thorn" draggable="true">
    <img src="azami.jpg" alt="" class="drag-and-drop icon" id="azami" draggable="true">
    <img src="solis.jpg" alt="" class="drag-and-drop icon" id="solis" draggable="true">
    <img src="fenrir.jpg" alt="" class="drag-and-drop icon" id="fenrir" draggable="true">
    <img src="tubarao.jpg" alt="" class="drag-and-drop icon" id="tubarao" draggable="true">
    <img src="denari.jpg" alt="" class="drag-and-drop icon" id="denari" draggable="true">

	  
    <div class="reinforcement_slot">
      <span>강화벽</span>
    </div>
    <img src="reinforcement.jpg" alt="" class="reinforcement gadget drag-and-drop" draggable="true">

    <div class="wire_slot">
      <span>철조망</span>
    </div>
    <img src="wire.jpg" alt="" class="wire gadget drag-and-drop" draggable="true">

    <div class="shield_slot">
      <span>이동식<br>방패</span>
    </div>
    <img src="shield.jpg" alt="" class="shield gadget drag-and-drop" draggable="true">

    <div class="camera_slot">
      <span>방탄<br>카메라</span>
    </div>
    <img src="camera.jpg" alt="" class="camera gadget drag-and-drop" draggable="true">

    <div class="impact_slot">
      <span>충격<br>수류탄</span>
    </div>
    <img src="impact.jpg" alt="" class="impact gadget drag-and-drop" draggable="true">

    <div class="c4_slot">
      <span>원격 제어 폭탄</span>
    </div>
    <img src="c4.jpg" alt="" class="c4 gadget drag-and-drop" draggable="true">

    <div class="barricade_slot">
      <span>바리케이드</span>
    </div>
    <img src="barricade.jpg" alt="" class="barricade gadget drag-and-drop" draggable="true">

    <div class="alarm_slot">
      <span>근접 알람</span>
    </div>
    <img src="alarm.jpg" alt="" class="alarm gadget drag-and-drop" draggable="true">

    <div class="observationblocker_slot">
	    <span>관측<br>차단기</span>
    </div>
    <img src="observationblocker.jpg" alt="" class="observationblocker gadget drag-and-drop" draggable="true">

  </div>
    

  <div class="general_slot">
    <img src="vault.png" alt="" class="drag-and-drop icon" id="vault" draggable="true">
    <img src="half.png" alt="" class="drag-and-drop icon" id="half" draggable="true">
    <img src="full.png" alt="" class="drag-and-drop icon" id="full" draggable="true">
    <img src="option.png" alt="" class="drag-and-drop bigicon" id="option" draggable="true">
    <img src="last.png" alt="" class="drag-and-drop smallicon" id="last" draggable="true">
    <img src="bullethole.png" alt="" class="drag-and-drop bhicon" id="bullethole" draggable="true">
	
  </div>
  <!-- 방어측 영역　끝 -->
  <!-- 아이콘 배치 영역　끝 -->

  
<!-- 그리기 영역 -->
  <div class="container">
    <div class="tabs">

      <input id="bank2f" type="radio" name="tab_item" checked="">
      <label class="L1 tab_item" for="bank2f">은행 2F</label>
      <input id="bank1f" type="radio" name="tab_item">
      <label class="L2 tab_item" for="bank1f">은행 1F</label>
      <input id="bankb1" type="radio" name="tab_item">
      <label class="L3 tab_item" for="bankb1">은행 B1</label>

      <input id="border2f" type="radio" name="tab_item">
      <label class="L4 tab_item" for="border2f">국경 2F</label>
      <input id="border1f" type="radio" name="tab_item">
      <label class="L5 tab_item" for="border1f">국경 1F</label>

      <input id="cafe3f" type="radio" name="tab_item">
      <label class="L6 tab_item" for="cafe3f">카페 3F</label>
      <input id="cafe2f" type="radio" name="tab_item">
      <label class="L7 tab_item" for="cafe2f">카페 2F</label>
      <input id="cafe1f" type="radio" name="tab_item">
      <label class="L8 tab_item" for="cafe1f">카페 1F</label>

      <input id="chalet2f" type="radio" name="tab_item">
      <label class="L9 tab_item" for="chalet2f">별장 2F</label>
      <input id="chalet1f" type="radio" name="tab_item">
      <label class="L10 tab_item" for="chalet1f">별장 1F</label>
      <input id="chaletb1" type="radio" name="tab_item">
      <label class="L11 tab_item" for="chaletb1">별장 B1</label>

      <input id="club2f" type="radio" name="tab_item">
      <label class="L12 tab_item" for="club2f">클럽하우스 2F</label>
      <input id="club1f" type="radio" name="tab_item">
      <label class="L13 tab_item" for="club1f">클럽하우스 1F</label>
      <input id="clubb1" type="radio" name="tab_item">
      <label class="L14 tab_item" for="clubb1">클럽하우스 B1</label>

	    <input id="oregon3f" type="radio" name="tab_item">
      <label class="L15 tab_item" for="oregon3f">오리건 3F</label>
      <input id="oregon2f" type="radio" name="tab_item">
	    <label class="L16 tab_item" for="oregon2f">오리건 2F</label>
      <input id="oregon1f" type="radio" name="tab_item">
      <label class="L17 tab_item" for="oregon1f">오리건 1F</label>
      <input id="oregonb1" type="radio" name="tab_item">
      <label class="L18 tab_item" for="oregonb1">오리건 B1</label>

      <input id="skyscraper2f" type="radio" name="tab_item">
	    <label class="L19 tab_item" for="skyscraper2f">마천루 2F</label>
      <input id="skyscraper1f" type="radio" name="tab_item">
      <label class="L20 tab_item" for="skyscraper1f">마천루 1F</label>

      <input id="villa2f" type="radio" name="tab_item">
	    <label class="L21 tab_item" for="villa2f">빌라 2F</label>
      <input id="villa1f" type="radio" name="tab_item">
      <label class="L22 tab_item" for="villa1f">빌라 1F</label>
      <input id="villab1" type="radio" name="tab_item">
      <label class="L23 tab_item" for="villab1">빌라 B1</label>

      <input id="themepark2f" type="radio" name="tab_item">
	    <label class="R1 tab_item" for="themepark2f">테마파크 2F</label>
      <input id="themepark1f" type="radio" name="tab_item">
      <label class="R2 tab_item" for="themepark1f">테마파크 1F</label>

	    <input id="lab2f" type="radio" name="tab_item">
      <label class="R3 tab_item" for="lab2f">나이트헤븐 연구소 2F</label>
	    <input id="lab1f" type="radio" name="tab_item">
      <label class="R4 tab_item" for="lab1f">나이트헤븐 연구소 1F</label>
	    <input id="labb1" type="radio" name="tab_item">
      <label class="R5 tab_item" for="labb1">나이트헤븐 연구소 B1</label>

      <input id="consulate2f" type="radio" name="tab_item">
	    <label class="R6 tab_item" for="consulate2f">영사관 2F</label>
      <input id="consulate1f" type="radio" name="tab_item">
      <label class="R7 tab_item" for="consulate1f">영사관 1F</label>
      <input id="consulateb1" type="radio" name="tab_item">
      <label class="R8 tab_item" for="consulateb1">영사관 B1</label>

      <input id="lair2f" type="radio" name="tab_item">
      <label class="R9 tab_item" for="lair2f">소굴 2F</label>
      <input id="lair1f" type="radio" name="tab_item">
      <label class="R10 tab_item" for="lair1f">소굴 1F</label>
      <input id="lairb1" type="radio" name="tab_item">
      <label class="R11 tab_item" for="lairb1">소굴 B1</label>

      <input id="coastline2f" type="radio" name="tab_item">
      <label class="R12 tab_item" for="coastline2f">해안선 2F</label>
      <input id="coastline1f" type="radio" name="tab_item">
      <label class="R13 tab_item" for="coastline1f">해안선 1F</label>

      <input id="kanal2f" type="radio" name="tab_item">
      <label class="R14 tab_item" for="kanal2f">운하 2F</label>
      <input id="kanal1f" type="radio" name="tab_item">
      <label class="R15 tab_item" for="kanal1f">운하 1F</label>
      <input id="kanalb1" type="radio" name="tab_item">
      <label class="R16 tab_item" for="kanalb1">운하 B1</label>
      <input id="kanalb2" type="radio" name="tab_item">
      <label class="R17 tab_item" for="kanalb2">운하 B2</label>

      <input id="outback2f" type="radio" name="tab_item">
      <label class="R18 tab_item" for="outback2f">오지 2F</label>
      <input id="outback1f" type="radio" name="tab_item">
      <label class="R19 tab_item" for="outback1f">오지 1F</label>


      <div class="tab_content" id="bank2f">
        <img src="bank2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="bank1f">
        <img src="bank1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="bankb1">
        <img src="bankb1.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="border2f">
        <img src="border2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="border1f">
        <img src="border1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="cafe3f">
        <img src="cafe3f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="cafe2f">
        <img src="cafe2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="cafe1f">
        <img src="cafe1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="club2f">
        <img src="club2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="club1f">
        <img src="club1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="clubb1">
        <img src="clubb1.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="coastline2f">
        <img src="coastline2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="coastline1f">
        <img src="coastline1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="consulate2f">
        <img src="consulate2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="consulate1f">
        <img src="consulate1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="consulateb1">
        <img src="consulateb1.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="villa2f">
        <img src="villa2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="villa1f">
        <img src="villa1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="villab1">
        <img src="villab1.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="outback2f">
        <img src="outback2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="outback1f">
        <img src="outback1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="skyscraper2f">
        <img src="skyscraper2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="skyscraper1f">
        <img src="skyscraper1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="oregon3f">
        <img src="oregon3f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="oregon2f">
        <img src="oregon2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="oregon1f">
        <img src="oregon1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="oregonb1">
        <img src="oregonb1.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="chalet2f">
        <img src="chalet2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="chalet1f">
        <img src="chalet1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="chaletb1">
        <img src="chaletb1.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="kanal2f">
        <img src="kanal2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="kanal1f">
        <img src="kanal1f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="kanalb1">
        <img src="kanalb1.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="kanalb2">
        <img src="kanalb2.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="themepark2f">
        <img src="themepark2f.jpg" alt="" class="map">
      </div>
      <div class="tab_content" id="themepark1f">
        <img src="themepark1f.jpg" alt="" class="map">
      </div>
	  <div class="tab_content" id="lab2f">
        <img src="lab2f.jpg" alt="" class="map">
      </div>
	  <div class="tab_content" id="lab1f">
        <img src="lab1f.jpg" alt="" class="map">
      </div>
	  <div class="tab_content" id="labb1">
        <img src="labb1.jpg" alt="" class="map">
      </div>
	  <div class="tab_content" id="lair2f">
        <img src="lair2f.png" alt="" class="map">
      </div>
	  <div class="tab_content" id="lair1f">
        <img src="lair1f.png" alt="" class="map">
      </div>
	  <div class="tab_content" id="lairb1">
        <img src="lairb1.png" alt="" class="map">
      </div>
    </div>

    <canvas id="canvas" width="1550" height="1050"></canvas><br>
    <div class="palette">
	<font size=2px;>
      <label>색상<input id="color" type="color"></label>
      <label>굵기<input id="width" type="number" min="1" max="50"></label>
      <input type="button" class="btn" id="reset_icon" value="아이콘 지우기" onclick="reset_icon()">
      <input type="button" class="btn" id="delete_canvas" value="낙서 지우기" onclick="delete_canvas()">
      <input type="button" class="btn" id="all_reset" value="전부 지우기" onclick="all_reset()">
      <input type="image" id="pencil" src="asse/ui/1.jpg" width="35px" class="active" onclick="tool(1)">
      <input type="image" id="eraser" src="asse/ui/2.jpg" width="35px" onclick="tool(2)">
      
      <div class="control-container">
        <label class="checkbox-label">
          <input type="checkbox" id="auto_clear" checked> 
          브라우저 종료 시 자동 초기화
        </label>
        <input type="button" id="clear_all_maps" value="모든 맵 데이터 삭제" onclick="clearAllMapsData()">
      </div>
	</font>

    </div>
  </div>
  <!-- 그리기 영역　끝 -->







  <script type="text/javascript">
/**
 * R6 맵 전략 툴 최적화 버전
 * - 중복 코드 제거, 구조화, 성능 개선, 유지보수성 향상
 */
const R6MapTool = (() => {
  // 상태 및 변수
  const mapList = [
    'bank2f', 'bank1f', 'bankb1', 'border2f', 'border1f', 'cafe3f', 'cafe2f', 'cafe1f',
    'chalet2f', 'chalet1f', 'chaletb1', 'club2f', 'club1f', 'clubb1', 'oregon3f', 'oregon2f',
    'oregon1f', 'oregonb1', 'skyscraper2f', 'skyscraper1f', 'villa2f', 'villa1f', 'villab1',
    'themepark2f', 'themepark1f', 'lab2f', 'lab1f', 'labb1', 'consulate2f', 'consulate1f',
    'consulateb1', 'lair2f', 'lair1f', 'lairb1', 'bartlett2f', 'bartlett1f', 'coastline2f',
    'coastline1f', 'kanal2f', 'kanal1f', 'kanalb1', 'kanalb2', 'outback2f', 'outback1f'
  ];
  let mapStates = {};
  let currentMap = 'bank2f';
  let draggedElement = null;
  let offset = { x: 0, y: 0 };
  let isClone = false;
  let defaultPositions = [];
  let canvas, ctx;
  let isDrawing = false, currentTool = 1, brushSize = 5, brushColor = '#FF0000';
  
  // 아이콘 토글 기능 변수
  let selectedIconForClicking = null;
  let cursorIcon = null;

  // --- 유틸리티 ---
  function isClonedIcon(element) {
    return element.id && element.id.includes('-clone-');
  }
  function getContainer() {
    return document.querySelector('.container');
  }
  function getCanvas() {
    return document.getElementById('canvas');
  }
  function getDragElements() {
    return document.getElementsByClassName("drag-and-drop");
  }
  function getClones() {
    return document.querySelectorAll('[id*="-clone-"]');
  }
  function getOriginalElements() {
    return document.querySelectorAll('.drag-and-drop:not([id*="-clone-"])');
  }
  function isWithinMapBounds(x, y) {
    const container = getContainer();
    return x >= 0 && x <= container.offsetWidth && y >= 0 && y <= container.offsetHeight;
  }
  function isCanvasPositionInBounds(x, y) {
    return x >= 0 && x <= canvas.width && y >= 0 && y <= canvas.height;
  }

  // --- 아이콘 토글 및 클릭 복제 기능 ---
  function createCursorIcon(originalIcon) {
    if (cursorIcon) {
      cursorIcon.remove();
    }
    
    const originalStyle = window.getComputedStyle(originalIcon);
    cursorIcon = originalIcon.cloneNode(true);
    cursorIcon.style.position = 'fixed';
    cursorIcon.style.pointerEvents = 'none';
    cursorIcon.style.zIndex = '10000';
    cursorIcon.style.opacity = '0.7';
    cursorIcon.style.width = originalStyle.width;
    cursorIcon.style.height = originalStyle.height;
    cursorIcon.style.border = originalStyle.border;
    cursorIcon.style.borderColor = originalStyle.borderColor;
    cursorIcon.style.borderRadius = originalStyle.borderRadius;
    cursorIcon.style.transform = 'translate(-50%, -50%)';
    cursorIcon.draggable = false;
    
    document.body.appendChild(cursorIcon);
    document.body.style.cursor = 'none';
  }

  function removeCursorIcon() {
    if (cursorIcon) {
      cursorIcon.remove();
      cursorIcon = null;
    }
    selectedIconForClicking = null;
    document.body.style.cursor = 'auto';
  }

  function updateCursorPosition(e) {
    if (cursorIcon) {
      cursorIcon.style.left = e.clientX + 'px';
      cursorIcon.style.top = e.clientY + 'px';
    }
  }

  function createIconAtClick(originalIcon, x, y) {
    const clone = originalIcon.cloneNode(true);
    const originalStyle = window.getComputedStyle(originalIcon);
    
    clone.style.position = 'absolute';
    clone.style.left = (x - 15) + 'px';
    clone.style.top = (y - 15) + 'px';
    clone.style.zIndex = '100';
    
    Object.assign(clone.style, {
      width: originalStyle.width, 
      height: originalStyle.height,
      border: originalStyle.border, 
      borderColor: originalStyle.borderColor,
      borderWidth: originalStyle.borderWidth, 
      borderStyle: originalStyle.borderStyle,
      borderRadius: originalStyle.borderRadius, 
      boxShadow: originalStyle.boxShadow,
      opacity: originalStyle.opacity, 
      transform: originalStyle.transform
    });
    
    clone.id = originalIcon.id + '-clone-' + Date.now();
    addCloneEventListeners(clone);
    getContainer().appendChild(clone);
    saveCurrentIconPositions();
  }

  function setupIconClickToggle() {
    // 원본 아이콘들에 우클릭 이벤트 추가
    getOriginalElements().forEach(icon => {
      icon.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        selectedIconForClicking = icon;
        createCursorIcon(icon);
      });
    });

    // 컨테이너에 클릭 이벤트 추가
    const container = getContainer();
    
    container.addEventListener('click', (e) => {
      if (selectedIconForClicking) {
        // 좌클릭으로 토글 해제
        removeCursorIcon();
      }
    });

    container.addEventListener('contextmenu', (e) => {
      if (selectedIconForClicking) {
        e.preventDefault();
        const containerRect = container.getBoundingClientRect();
        const x = e.clientX - containerRect.left;
        const y = e.clientY - containerRect.top;
        
        if (isWithinMapBounds(x, y)) {
          createIconAtClick(selectedIconForClicking, x, y);
        }
      }
    });

    // 마우스 이동 시 커서 아이콘 위치 업데이트
    document.addEventListener('mousemove', updateCursorPosition);

    // ESC 키로 토글 해제
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && selectedIconForClicking) {
        removeCursorIcon();
      }
    });
  }

  // --- 상태 관리 ---
  function initializeMapStates() {
    mapList.forEach(mapId => {
      mapStates[mapId] = { canvasData: null, iconPositions: [], clonedIcons: [] };
    });
  }
  function saveCurrentCanvasState() {
    mapStates[currentMap].canvasData = canvas.toDataURL();
  }
  function saveCurrentIconPositions() {
    // 원본 위치
    const positions = [];
    const elements = getDragElements();
    for (let i = 0; i < elements.length; i++) {
      if (!isClonedIcon(elements[i])) {
        positions.push({ index: i, top: elements[i].style.top, left: elements[i].style.left });
      }
    }
    mapStates[currentMap].iconPositions = positions;
    // 복제 아이콘
    const clonedIcons = [];
    getClones().forEach(clone => {
      const computedStyle = window.getComputedStyle(clone);
      clonedIcons.push({
        id: clone.id,
        src: clone.src,
        className: clone.className,
        left: clone.style.left,
        top: clone.style.top,
        originalId: clone.id.split('-clone-')[0],
        styles: {
          width: computedStyle.width, height: computedStyle.height,
          border: computedStyle.border, borderColor: computedStyle.borderColor,
          borderWidth: computedStyle.borderWidth, borderStyle: computedStyle.borderStyle,
          borderRadius: computedStyle.borderRadius, boxShadow: computedStyle.boxShadow,
          opacity: computedStyle.opacity, transform: computedStyle.transform
        }
      });
    });
    mapStates[currentMap].clonedIcons = clonedIcons;
  }
  function restoreIconPositions(mapId) {
    // 복제 아이콘 제거
    getClones().forEach(clone => clone.remove());
    // 원본 위치 복원
    const elements = getDragElements();
    const positions = mapStates[mapId]?.iconPositions || [];
    if (positions.length > 0) {
      positions.forEach(pos => {
        if (elements[pos.index] && !isClonedIcon(elements[pos.index])) {
          elements[pos.index].style.top = pos.top;
          elements[pos.index].style.left = pos.left;
        }
      });
    } else {
      // 기본 위치
      for (let i = 0; i < elements.length; i++) {
        if (!isClonedIcon(elements[i]) && defaultPositions[i]) {
          elements[i].style.top = defaultPositions[i].top;
          elements[i].style.left = defaultPositions[i].left;
        }
      }
    }
    // 복제 아이콘 복원
    (mapStates[mapId]?.clonedIcons || []).forEach(cloneData => {
      const clone = document.createElement('img');
      clone.src = cloneData.src;
      clone.className = cloneData.className;
      clone.id = cloneData.id;
      clone.style.position = 'absolute';
      clone.style.left = cloneData.left;
      clone.style.top = cloneData.top;
      clone.style.zIndex = '100';
      clone.draggable = true;
      Object.assign(clone.style, cloneData.styles);
      addCloneEventListeners(clone);
      getContainer().appendChild(clone);
    });
  }
  function restoreCanvasState(mapId) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (mapStates[mapId]?.canvasData) {
      const img = new Image();
      img.onload = () => ctx.drawImage(img, 0, 0);
      img.src = mapStates[mapId].canvasData;
    }
  }

  // --- 아이콘 드래그 앤 드롭 ---
  function addCloneEventListeners(clone) {
    clone.addEventListener('dragstart', handleDragStart);
    clone.addEventListener('dragend', handleDragEnd);
    clone.addEventListener('dblclick', () => { clone.remove(); saveCurrentIconPositions(); });
    clone.addEventListener('drag', e => {
      if (e.clientX === 0 && e.clientY === 0) return;
      const containerRect = getContainer().getBoundingClientRect();
      const x = e.clientX - containerRect.left;
      const y = e.clientY - containerRect.top;
      if (!isWithinMapBounds(x, y)) {
        clone.remove();
        saveCurrentIconPositions();
      }
    });
    clone.addEventListener('dragend', e => {
      const containerRect = getContainer().getBoundingClientRect();
      const cloneRect = clone.getBoundingClientRect();
      const x = cloneRect.left - containerRect.left;
      const y = cloneRect.top - containerRect.top;
      if (!isWithinMapBounds(x, y)) {
        clone.remove();
        saveCurrentIconPositions();
      }
    });
  }
  function handleDragStart(e) {
    draggedElement = e.target;
    isClone = isClonedIcon(e.target);
    const rect = e.target.getBoundingClientRect();
    offset.x = e.clientX - rect.left;
    offset.y = e.clientY - rect.top;
    e.dataTransfer.effectAllowed = isClone ? 'move' : 'copy';
    e.dataTransfer.setData('text/html', e.target.outerHTML);
  }
  function handleDragEnd() {
    draggedElement = null;
    isClone = false;
  }
  function handleDragOver(e) {
    e.preventDefault();
    e.dataTransfer.dropEffect = isClone ? 'move' : 'copy';
  }
  function handleDrop(e) {
    e.preventDefault();
    if (!draggedElement) return;
    const containerRect = getContainer().getBoundingClientRect();
    const x = e.clientX - containerRect.left - offset.x;
    const y = e.clientY - containerRect.top - offset.y;
    if (!isWithinMapBounds(x, y)) {
      if (isClone) {
        draggedElement.remove();
        saveCurrentIconPositions();
      }
      return;
    }
    if (isClone) {
      draggedElement.style.left = x + 'px';
      draggedElement.style.top = y + 'px';
    } else {
      const clone = draggedElement.cloneNode(true);
      const originalStyle = window.getComputedStyle(draggedElement);
      clone.style.position = 'absolute';
      clone.style.left = x + 'px';
      clone.style.top = y + 'px';
      clone.style.zIndex = '100';
      Object.assign(clone.style, {
        width: originalStyle.width, height: originalStyle.height,
        border: originalStyle.border, borderColor: originalStyle.borderColor,
        borderWidth: originalStyle.borderWidth, borderStyle: originalStyle.borderStyle,
        borderRadius: originalStyle.borderRadius, boxShadow: originalStyle.boxShadow,
        opacity: originalStyle.opacity, transform: originalStyle.transform
      });
      clone.id = draggedElement.id + '-clone-' + Date.now();
      addCloneEventListeners(clone);
      getContainer().appendChild(clone);
    }
    saveCurrentIconPositions();
  }
  function initializeDragAndDrop() {
    Array.from(getDragElements()).forEach(element => {
      element.addEventListener('dragstart', handleDragStart);
      element.addEventListener('dragend', handleDragEnd);
      if (isClonedIcon(element)) {
        element.addEventListener('dblclick', () => {
          element.remove();
          saveCurrentIconPositions();
        });
      }
    });
    getContainer().addEventListener('dragover', handleDragOver);
    getContainer().addEventListener('drop', handleDrop);
  }

// --- 리셋/초기화 ---
function resetIcons() {
  // confirm 제거
  removeCursorIcon(); // 토글 해제
  getOriginalElements().forEach((el, i) => {
    if (defaultPositions[i]) {
      el.style.top = defaultPositions[i].top;
      el.style.left = defaultPositions[i].left;
    }
  });
  getClones().forEach(clone => clone.remove());
  mapStates[currentMap].iconPositions = [];
  mapStates[currentMap].clonedIcons = [];
}
function deleteCanvas() {
  // confirm 제거
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  mapStates[currentMap].canvasData = null;
}
function resetAll() {
  // confirm 제거
  removeCursorIcon(); // 토글 해제
  resetIcons();
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  mapStates[currentMap].canvasData = null;
}
function clearAllMapsData() {
  // confirm 제거
  removeCursorIcon(); // 토글 해제
  localStorage.removeItem('r6mapstates');
  initializeMapStates();
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  getClones().forEach(clone => clone.remove());
  getOriginalElements().forEach((el, i) => {
    if (defaultPositions[i]) {
      el.style.top = defaultPositions[i].top;
      el.style.left = defaultPositions[i].left;
    }
  });
  alert('모든 맵의 데이터가 삭제되었습니다.');
}

  // --- 저장/불러오기 ---
  function saveAllStates() {
    saveCurrentCanvasState();
    saveCurrentIconPositions();
    localStorage.setItem('r6mapstates', JSON.stringify(mapStates));
  }
  function loadAllStates() {
    const savedStates = localStorage.getItem('r6mapstates');
    if (savedStates) {
      mapStates = JSON.parse(savedStates);
      restoreCanvasState(currentMap);
      restoreIconPositions(currentMap);
    }
  }

  // --- 맵 변경 ---
  function setupMapChangeListeners() {
    document.querySelectorAll('input[name="tab_item"]').forEach(radio => {
      radio.addEventListener('change', function() {
        if (this.checked) {
          saveCurrentCanvasState();
          saveCurrentIconPositions();
          currentMap = this.id;
          restoreCanvasState(currentMap);
          restoreIconPositions(currentMap);
        }
      });
    });
  }

  // --- 이미지 경로 자동 변경 ---
  function autoChangeImagePaths() {
    // 공격측
    document.querySelectorAll('.attack_slot .icon').forEach(img => {
      const src = img.getAttribute('src');
      if (src && !src.includes('/')) img.src = 'asse/AT/' + src;
    });
    // 방어측
    document.querySelectorAll('.defense_slot .icon').forEach(img => {
      const src = img.getAttribute('src');
      if (src && !src.includes('/')) img.src = 'asse/DF/' + src;
    });
    // 가젯
    document.querySelectorAll('.gadget').forEach(img => {
      const src = img.getAttribute('src');
      if (src && !src.includes('/')) img.src = 'asse/gadget/' + src;
    });
    // 맵
    document.querySelectorAll('.map').forEach(img => {
      const src = img.getAttribute('src');
      if (src && !src.includes('/')) img.src = 'asse/maps/' + src;
    });
    // 기타
    document.querySelectorAll('.general_slot img').forEach(img => {
      const src = img.getAttribute('src');
      if (src && !src.includes('/')) img.src = 'asse/general/' + src;
    });
  }

  // --- 캔버스 드로잉 ---
  function tool(toolNumber) {
    currentTool = toolNumber;
    document.getElementById('pencil').classList.toggle('active', toolNumber === 1);
    document.getElementById('eraser').classList.toggle('active', toolNumber === 2);
    canvas.style.cursor = toolNumber === 1 ? 'crosshair' : 'grab';
  }
  function initializeDrawing() {
    const colorInput = document.getElementById('color');
    const widthInput = document.getElementById('width');
    if (colorInput) {
      colorInput.value = '#FF0000';
      colorInput.addEventListener('change', function() { brushColor = this.value; });
    }
    if (widthInput) {
      widthInput.value = 5;
      widthInput.addEventListener('change', function() { brushSize = parseInt(this.value); });
    }
    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);
    canvas.addEventListener('touchstart', handleTouch);
    canvas.addEventListener('touchmove', handleTouch);
    canvas.addEventListener('touchend', stopDrawing);
    tool(1);
  }
  function startDrawing(e) {
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    if (!isCanvasPositionInBounds(x, y)) return;
    isDrawing = true;
    ctx.beginPath();
    ctx.moveTo(x, y);
  }
  function draw(e) {
    if (!isDrawing) return;
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    if (!isCanvasPositionInBounds(x, y)) { stopDrawing(); return; }
    ctx.lineWidth = brushSize;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    ctx.globalCompositeOperation = currentTool === 1 ? 'source-over' : 'destination-out';
    ctx.strokeStyle = brushColor;
    ctx.lineTo(x, y);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x, y);
  }
  function stopDrawing() {
    if (isDrawing) {
      isDrawing = false;
      ctx.beginPath();
      saveCurrentCanvasState();
    }
  }
  function handleTouch(e) {
    e.preventDefault();
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    const x = touch.clientX - rect.left;
    const y = touch.clientY - rect.top;
    if (!isCanvasPositionInBounds(x, y) && isDrawing) { stopDrawing(); return; }
    const mouseEvent = new MouseEvent(
      e.type === 'touchstart' ? 'mousedown' :
      e.type === 'touchmove' ? 'mousemove' : 'mouseup',
      { clientX: touch.clientX, clientY: touch.clientY }
    );
    canvas.dispatchEvent(mouseEvent);
  }

  // --- 초기화 및 이벤트 통합 ---
  function init() {
    canvas = getCanvas();
    ctx = canvas.getContext('2d');
    initializeMapStates();
    setupMapChangeListeners();
    initializeDragAndDrop();
    initializeDrawing();
    setupIconClickToggle(); // 아이콘 클릭 토글 기능 추가
    autoChangeImagePaths();
    // 기본 위치 저장
    defaultPositions = Array.from(getDragElements()).map(el => ({
      top: el.style.top, left: el.style.left
    }));
    loadAllStates();
    // 자동 초기화 체크박스
    const autoClear = document.getElementById('auto_clear');
    const savedAutoClear = localStorage.getItem('autoClearEnabled');
    if (autoClear && savedAutoClear !== null) {
      autoClear.checked = savedAutoClear === 'true';
      autoClear.addEventListener('change', function() {
        localStorage.setItem('autoClearEnabled', this.checked);
      });
    }
    // 버튼 이벤트
    document.getElementById('reset_icon').onclick = resetIcons;
    document.getElementById('delete_canvas').onclick = deleteCanvas;
    document.getElementById('all_reset').onclick = resetAll;
    document.getElementById('clear_all_maps').onclick = clearAllMapsData;
    document.getElementById('pencil').onclick = () => tool(1);
    document.getElementById('eraser').onclick = () => tool(2);
  }

  // 저장/삭제 on unload
  window.addEventListener('beforeunload', function() {
    const autoClear = document.getElementById('auto_clear');
    if (autoClear && autoClear.checked) {
      localStorage.removeItem('r6mapstates');
    } else {
      saveAllStates();
    }
  });

  // 외부에서 호출할 수 있는 함수(필요시)
  return {
    init,
    save_current_state: () => { saveCurrentCanvasState(); saveCurrentIconPositions(); alert('현재 맵 상태가 저장되었습니다.'); },
    load_current_state: () => { restoreCanvasState(currentMap); restoreIconPositions(currentMap); alert('현재 맵 상태가 복원되었습니다.'); }
  };
})();

document.addEventListener('DOMContentLoaded', R6MapTool.init);
  </script>

</body>
</html>
